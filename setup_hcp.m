fs = 1/.72;
[b,a] = butter(3,[.125]/(fs/2),'low');
nNodes = 333;
nSubs = 100;
id1plus = [4;10;11;4;13;4;6;13;6;1;7;3;8;8;13;13;13;7;7;13;2;2;12;6;4;4;2;2;9;10;10;10;10;2;10;10;10;10;11;2;5;5;5;4;10;10;10;10;5;10;5;5;11;10;5;10;10;10;11;12;12;12;2;1;1;1;1;1;1;1;2;2;7;5;12;2;1;6;12;12;2;2;9;2;12;12;5;5;3;13;5;5;3;4;5;6;13;13;13;5;2;1;2;1;2;5;5;6;6;5;2;2;5;4;7;4;4;7;7;7;7;7;7;7;7;4;4;7;7;8;13;13;7;7;7;13;13;13;13;13;13;7;8;7;4;4;2;6;6;4;4;4;2;4;5;4;4;12;7;1;12;4;10;11;4;13;6;6;13;6;1;7;3;8;13;13;13;7;7;2;2;6;9;4;2;4;2;2;5;10;10;2;10;10;10;2;11;2;5;4;10;10;5;10;10;10;10;5;10;10;5;11;10;10;10;10;10;11;2;4;12;12;2;1;4;12;1;12;12;1;12;1;1;2;2;5;12;2;1;6;12;12;12;1;2;2;9;2;2;5;13;5;5;3;13;13;4;13;4;6;6;5;13;13;13;5;13;1;1;10;5;6;6;2;5;6;6;4;4;7;7;7;7;7;7;7;7;7;7;4;7;7;13;8;8;7;7;13;13;7;7;7;7;7;7;7;13;13;13;13;13;7;8;7;4;4;2;2;6;6;4;4;4;4;4;4;6;6;1;1;4;12;12];
[order_id,sort_id] = sort(id1plus);
unrelated = [100307;100408;101107;101309;101915;103111;103414;103818;105014;105115;106016;108828;110411;111312;111716;113619;113922;114419;115320;116524;117122;118528;118730;118932;120111;122317;122620;123117;123925;124422;125525;126325;127630;127933;128127;128632;129028;130013;130316;131217;131722;133019;133928;135225;135932;136833;138534;139637;140925;144832;146432;147737;148335;148840;149337;149539;149741;151223;151526;151627;153025;154734;156637;159340;160123;161731;162733;163129;176542;178950;188347;189450;190031;192540;196750;198451;199655;201111;208226;211417;211720;212318;214423;221319;239944;245333;280739;298051;366446;397760;414229;499566;654754;672756;751348;756055;792564;856766;857263;899885];
reg = [1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;4;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;6;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7;7];

order = {'emotion','gamble','language','motor','nback','relation','social'};
    
nSub = 21; nCbm = 28;
sub_id = [0;0;0;1;2;3;4;0;5;6;7;0;0;0;8;9;10;11;12;13;14];

for i = 1:nSubs

    cd ~/Documents/Drafts/Completed/Integration/data/emotion/sub/
    
    abc = sprintf('%s%d%s','data = dlmread(''',unrelated(i),'.tsv'',''\t'',1,1);');
    eval(abc)
    
    data = data(sort_id,:);
    
    nTime1 = size(data,2);
    
    for j = 1:nSub
        data1(j,:) = zscore(data(j,:));
        data2(j,:) = filtfilt(b,a,data1(j,:));
    end

    for s = 1:max(sub_id)
        data2(s,:) = data2(sub_id==s,:);
    end

    for t = 1:nTime1       
        data3(:,t) = zscore(data2(:,t));
    end
    
    
    
    data_grp(334:347,1:nTime1,i) = data3;
    
    clear data1 data2 data3
    
    cd ~/Documents/Drafts/Completed/Integration/data/emotion/cbm/
    
    abc = sprintf('%s%d%s','data = dlmread(''',unrelated1(i),'.tsv'',''\t'',1,1);');
    eval(abc)
    
    data = data(sort_id,:);
    
    nTime1 = size(data,2);
    
    for j = 1:nCbm
        data1(j,:) = zscore(data(j,:));
        data2(j,:) = filtfilt(b,a,data1(j,:));
    end
    
    for t = 1:nTime1       
        data3(:,t) = zscore(data2(:,t));
    end
    
    data_grp(348:75,1:nTime1,i) = data3;
    
    clear data1 data2 data3
    
    
    
    
    
    cd ../gamble
    
    abc = sprintf('%s%d%s','data = dlmread(''',unrelated(i),'.tsv'',''\t'',1,1);');
    eval(abc)
    
    data = data(sort_id,:);
    
    nTime2 = size(data,2);
    
    for j = 1:nNodes
        data1(j,:) = zscore(data(j,:));
        data2(j,:) = filtfilt(b,a,data1(j,:));
    end
    
    for t = 1:nTime2    
        data3(:,t) = zscore(data2(:,t));
    end
    
    nTimeTot = nTime1 + nTime2;
    
    data_grp1(:,nTime1+1:nTimeTot,i) = data3;
    
    
    clear data1 data2 data3
    
    
    
    
    
    cd ../language
    
    abc = sprintf('%s%d%s','data = dlmread(''',unrelated(i),'.tsv'',''\t'',1,1);');
    eval(abc)
    
    data = data(sort_id,:);
    
    nTime3 = size(data,2);
    
    for j = 1:nNodes
        data1(j,:) = zscore(data(j,:));
        data2(j,:) = filtfilt(b,a,data1(j,:));
    end
    
    for t = 1:nTime3    
        data3(:,t) = zscore(data2(:,t));
    end
    
    nTimeTot = nTime1 + nTime2 + nTime3;
    
    data_grp1(:,nTime1+nTime2+1:nTimeTot,i) = data3;
    
    
    clear data1 data2 data3
    
    cd ../motor
    
    abc = sprintf('%s%d%s','data = dlmread(''',unrelated(i),'.tsv'',''\t'',1,1);');
    eval(abc)
    
    data = data(sort_id,:);
    
    nTime4 = size(data,2);
    
    for j = 1:nNodes
        data1(j,:) = zscore(data(j,:));
        data2(j,:) = filtfilt(b,a,data1(j,:));
    end
    
    for t = 1:nTime4    
        data3(:,t) = zscore(data2(:,t));
    end
    
    nTimeTot = nTime1 + nTime2 + nTime3 + nTime4;
    nTimeStart = nTimeTot - nTime4;
    
    data_grp1(:,nTimeStart+1:nTimeTot,i) = data3;
    
    
    clear data1 data2 data3
    
    
    cd ../nback
    
    abc = sprintf('%s%d%s','data = dlmread(''',unrelated(i),'.tsv'',''\t'',1,1);');
    eval(abc)
    
    data = data(sort_id,:);
    
    nTime5 = size(data,2);
    
    for j = 1:nNodes
        data1(j,:) = zscore(data(j,:));
        data2(j,:) = filtfilt(b,a,data1(j,:));
    end
    
    for t = 1:nTime5    
        data3(:,t) = zscore(data2(:,t));
    end
    
    nTimeTot = nTime1 + nTime2 + nTime3 + nTime4 + nTime5;
    nTimeStart = nTimeTot - nTime5;
    
    data_grp1(:,nTimeStart+1:nTimeTot,i) = data3;
    
    
    clear data1 data2 data3
    
    
    
    cd ../relation
    
    abc = sprintf('%s%d%s','data = dlmread(''',unrelated(i),'.tsv'',''\t'',1,1);');
    eval(abc)
    
    data = data(sort_id,:);
    
    nTime6 = size(data,2);
    
    for j = 1:nNodes
        data1(j,:) = zscore(data(j,:));
        data2(j,:) = filtfilt(b,a,data1(j,:));
    end
    
    for t = 1:nTime6    
        data3(:,t) = zscore(data2(:,t));
    end
    
    nTimeTot = nTime1 + nTime2 + nTime3 + nTime4 + nTime5 + nTime6;
    nTimeStart = nTimeTot - nTime6;
    
    data_grp1(:,nTimeStart+1:nTimeTot,i) = data3;
    
    clear data1 data2 data3
    
    
    cd ../social
    
    abc = sprintf('%s%d%s','data = dlmread(''',unrelated(i),'.tsv'',''\t'',1,1);');
    eval(abc)
    
    data = data(sort_id,:);
    
    nTime7 = size(data,2);
    
    for j = 1:nNodes
        data1(j,:) = zscore(data(j,:));
        data2(j,:) = filtfilt(b,a,data1(j,:));
    end
    
    for t = 1:nTime7    
        data3(:,t) = zscore(data2(:,t));
    end
    
    nTimeTot = nTime1 + nTime2 + nTime3 + nTime4 + nTime5 + nTime6 + nTime7;
    nTimeStart = nTimeTot - nTime7;
    
    data_grp1(:,nTimeStart+1:nTimeTot,i) = data3;
    
    clear data1 data2 data3
    
    
    sprintf('%d',i)
    
end
